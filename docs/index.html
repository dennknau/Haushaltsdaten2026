<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interaktiver Haushaltsplan der Gemeinde Jesberg</title>

  <link href="https://unpkg.com/tabulator-tables@6.3.1/dist/css/tabulator.min.css" rel="stylesheet">
  <script src="https://unpkg.com/tabulator-tables@6.3.1/dist/js/tabulator.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>

  <style>
    body{
      font-family:"Calibri Light", Calibri, "Segoe UI", Arial, sans-serif;
      margin:20px;
      background:#078930;
      color:#111;
    }
    h1{font-size:1.6rem;font-weight:600;margin:0 0 8px 0;color:#fff;}
    h2{font-size:1.2rem;font-weight:600;margin:0 0 12px 0;color:#111;}

    .card{
      background:#fff;
      border-radius:12px;
      padding:16px;
      margin-top:16px;
      box-shadow:0 2px 8px rgba(0,0,0,.08);
    }

    .filters{display:flex;flex-direction:column;gap:14px;max-width:560px;}
    .filterRow{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:end;}
    label{font-weight:600;display:block;margin-bottom:6px;}
    select{width:100%;font-family:inherit;}
    select.multi{min-height:150px;}
    button{
      padding:8px 12px;border-radius:10px;border:1px solid #ddd;background:#fff;cursor:pointer;
      font-family:inherit;white-space:nowrap;
    }
    button:hover{background:#f2f2f2;}
    .hint{color:#555;font-size:.9rem;}

    table.summary{width:100%;border-collapse:collapse;}
    table.summary th, table.summary td{padding:10px 12px;border-top:1px solid #eee;vertical-align:middle;}
    table.summary th{text-align:left;font-weight:600;}
    .num{text-align:right;white-space:nowrap;font-variant-numeric:tabular-nums;}
    .barWrap{width:100%;height:14px;background:#e6e6e6;border-radius:999px;overflow:hidden;}
    .bar{height:100%;width:0%;border-radius:999px;}
    .bar.red{background:#d32f2f;}
    .bar.green{background:#2e7d32;}
    .bar.gray{background:#616161;}

    .pieGrid{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
    @media(max-width:900px){.pieGrid{grid-template-columns:1fr;}}
    .pieBox{height:420px;}
  </style>
</head>
<body>

  <h1>Interaktiver Haushaltsplan der Gemeinde Jesberg</h1>

  <div class="card">
    <div class="filters">

      <div class="filterRow">
        <div>
          <label for="jahrSelect">Jahr</label>
          <select id="jahrSelect"></select>
        </div>
        <button id="resetJahr" type="button">Zurücksetzen</button>
      </div>

      <div class="filterRow">
        <div>
          <label for="gruppe1Select">Gruppe 1</label>
          <select id="gruppe1Select"></select>
        </div>
        <button id="resetGruppe1" type="button">Zurücksetzen</button>
      </div>

      <div class="filterRow">
        <div>
          <label for="gruppeSelect">Kostenstellen</label>
          <select id="gruppeSelect" class="multi" multiple></select>
          <div class="hint">Mehrfachauswahl: Strg/Cmd halten · Keine Auswahl = alle</div>
        </div>
        <button id="resetGruppe" type="button">Zurücksetzen</button>
      </div>

      <div class="hint" id="status"></div>
    </div>
  </div>

  <div class="card">
    <h2>Gesamtübersicht</h2>
    <table class="summary">
      <thead>
        <tr>
          <th>Kennzahl</th>
          <th>Grafik</th>
          <th class="num">Summe</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Erträge gesamt</td>
          <td><div class="barWrap"><div id="barErtrag" class="bar green"></div></div></td>
          <td id="sumErtrag" class="num">–</td>
        </tr>
        <tr>
          <td>Aufwendungen gesamt</td>
          <td><div class="barWrap"><div id="barAufwand" class="bar red"></div></div></td>
          <td id="sumAufwand" class="num">–</td>
        </tr>
        <tr>
          <td><b>Ergebnis</b></td>
          <td><div class="barWrap"><div id="barErgebnis" class="bar gray"></div></div></td>
          <td id="sumErgebnis" class="num"><b>–</b></td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="card">
    <h2>Kreisdiagramme nach Kontogruppe</h2>
    <div class="pieGrid">
      <div>
        <div class="hint" style="margin-bottom:8px;">Erträge nach Kontogruppe</div>
        <div id="pieErtraege" class="pieBox"></div>
      </div>
      <div>
        <div class="hint" style="margin-bottom:8px;">Aufwendungen nach Kontogruppe</div>
        <div id="pieAufwendungen" class="pieBox"></div>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>Ergebnisübersicht</h2>
    <div id="table"></div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
